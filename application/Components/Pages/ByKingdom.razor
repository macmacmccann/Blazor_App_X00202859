@page "/bykingdom"
@inject HttpClient Http
@using application.Components
@using application.Components.Layout
@inject application.Services.SpeciesService SpeciesService;
@inject application.Services.WikipediaService WikipediaService;

<button class="back" onclick="history.back()">  ⇠ BACK </button>


<div class="explainNicely">
    <h1> EXPLORE THE KINGDOMS OF THE BIOLOGICAL CLASSIFICATION RANKS </h1>
</div>
<br />




<ul class="gridlist">
    @foreach (var s in kingdom)
    {

        <li class="list">

            <NavLink href=@($"/rankdescription/{s.canonicalName}/{s.key}")>
                @s.kingdom
            </NavLink>
        </li>
    }

</ul>

@code {


    // $"https://api.gbif.org/v1/species/{key}/children" eg., key 1 lists all phyum under animalia

    List<Species> kingdom = new();



    protected override async Task OnInitializedAsync()
    {
        var response = await Http.GetFromJsonAsync<SpeciesSearchResponse>("https://api.gbif.org/v1/species?rank=KINGDOM&status=ACCEPTED&limit=100");
        //  kingdom = response?.results ?? new List<Species>();

        kingdom = response?.results
        .GroupBy(s => s.kingdom)
        .Select(g => g.First())
        .ToList() ?? new();


    }
}
